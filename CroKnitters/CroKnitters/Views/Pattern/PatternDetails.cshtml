@model PatternDetailViewModel
@{
    ViewData["Title"] = "Pattern Details";
}

<div class="container mx-auto">

    <div class="flex flex-wrap justify-center mt-10 items-stretch">

        <div class="text-5xl font-extrabold text-center">
            <span>
                Pattern Details
            </span>
        </div>

        <div class=" rounded-lg border text-center shadow-xl m-5 justify-content-start bg-white">

            <!--show Pattern Details when clicked-->
            <div class="patternDetail">
                <!--show the images, name, description, creation date, stitch type, stitch count-->
                <!--images in a row-->
                @if (Model.ActivePattern.PatternImages.Count > 0)
                {
                    @foreach (var image in Model.Images)
                    {

                        <div class=" aspect-h-1 aspect-w-1 overflow-hidden rounded-lg bg-gray-200 xl:aspect-h-8 xl:aspect-w-7">
                            <img src="@("~/img/patterns/"+image)" asp-append-version="true" width="300px" height="300px" alt="Pattern image" class="object-cover object-center group-hover:opacity-75">
                        </div>
                    }

                }

                <div class="p-5">
                    <dl class="row">
                        <dt class="col-sm-2">
                            Pattern Name
                        </dt>
                        <dd class="col-sm-10">
                            @Html.DisplayFor(model => model.ActivePattern.PatternName)
                            by @Html.DisplayFor(model => model.ActivePattern.Owner.FirstName)
                            @Html.DisplayFor(model => model.ActivePattern.Owner.LastName)
                        </dd>

                        <dt class="col-sm-2">
                            Creator
                        </dt>
                        <dd class="col-sm-10">
                            @Html.DisplayFor(model => model.ActivePattern.Owner.FirstName)
                            @Html.DisplayFor(model => model.ActivePattern.Owner.LastName)
                        </dd>

                        @if (Model.ActivePattern.Description != null)
                        {
                            <dt class="col-sm-2">
                                Description
                            </dt>
                            <dd class="col-sm-10">
                                @Html.DisplayFor(model => model.ActivePattern.Description)
                            </dd>
                        }


                        <dt class="col-sm-2">
                            Date Created
                        </dt>
                        <dd class="col-sm-10">
                            @Html.DisplayFor(model => model.ActivePattern.CreationDate)
                        </dd>


                        @if (Model.ActivePattern.StitchType != null)
                        {
                            <dt class="col-sm-2">
                                Stitch Type
                            </dt>
                            <dd class="col-sm-10">
                                @Html.DisplayFor(model => model.ActivePattern.StitchType)
                            </dd>
                        }

                        @if (Model.ActivePattern.StitchCount != null)
                        {
                            <dt class="col-sm-2">
                                Stitch Count
                            </dt>
                            <dd class="col-sm-10">
                                @Html.DisplayFor(model => model.ActivePattern.StitchCount)
                            </dd>
                        }

                        @if (Model.ActivePattern.PatternTags != null)
                        {
                            @foreach (var tag in Model.TagNames)
                            {
                                <dt class="col-sm-2">
                                    Tags
                                </dt>
                                <dd class="col-sm-10">
                                    @tag
                                </dd>
                            }
                        }

                        <dt class="col-sm-2">
                            Likes
                        </dt>
                        <dd class="col-sm-10">
                            @Html.DisplayFor(model => model.ActivePattern.Likes)
                        </dd>

                    </dl>
                </div>

                <div class="container row p-3">
                    <h2 class="text-bold text-2xl">Recommended Patterns</h2>
                    @foreach (var recommendedPattern in ViewBag.RecommendedPatterns)
                    {
                        <div class="col-md-3 mb-4">
                            <div class="card h-100">
                                <a asp-controller="Pattern" asp-action="Details" asp-route-id="@recommendedPattern.ActivePattern.PatternId" class="group m-2 grid-item">
                                    @if (@recommendedPattern.ActivePattern.PatternImages.Count > 0)
                                    {
                                        @foreach (var firstImageSrc in recommendedPattern.Images)
                                        {

                                            <div class="aspect-h-1 aspect-w-1 w-full overflow-hidden rounded-lg bg-gray-200 xl:aspect-h-8 xl:aspect-w-7">
                                                <img src="@("~/img/patterns/"+firstImageSrc)" asp-append-version="true" width="300px" height="300px" alt="Pattern image" class="h-full w-full object-cover object-center group-hover:opacity-75">
                                            </div>
                                        }

                                }
                                    <h3 class="mt-4 text-sm text-gray-700 font-bold">@recommendedPattern.ActivePattern.PatternName</h3>
                                    <p class="mt-1 text-lg font-medium text-gray-900"> by @recommendedPattern.ActivePattern.Owner.FirstName @recommendedPattern.ActivePattern.Owner.LastName</p>
                                    <p class="mt-1 text-lg font-medium text-gray-900"><i class="bi bi-suit-heart"></i> @recommendedPattern.ActivePattern.Likes</p>
                                    <p class="mt-1 text-lg font-medium text-gray-900"><i class="bi bi-chat-heart"></i>@recommendedPattern.NumberOfComments </p> <!--fix this-->
                                </a>
                            </div>
                        </div>
                    }
                </div>

                <!--comments-->
                <div class="p-2">
                    <a asp-controller="Pattern" asp-action="ViewComments" class="w-auto justify-center rounded-md bg-indigo-600 m-3 px-3 py-1.5 text-sm font-semibold leading-6 text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 mt-2">See Comments</a>
                    <a asp-controller="Pattern" asp-action="Index" class="w-auto justify-center rounded-md bg-indigo-600 m-3 px-3 py-1.5 text-sm font-semibold leading-6 text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 mt-2"> See all my Patterns</a>
                    <a asp-controller="Home" asp-action="Index" class="w-auto justify-center rounded-md bg-indigo-600 m-3 px-3 py-1.5 text-sm font-semibold leading-6 text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 mt-2"> Back to Home</a>
                    @if (Context.Request.Cookies["userId"] != null && Model.ActivePattern.OwnerId == Int32.Parse(Context.Request.Cookies["userId"]))
                    {
                        <a asp-controller="Pattern" asp-action="EditPattern" asp-route-id="@Model.ActivePattern.PatternId" class="w-auto justify-center rounded-md bg-indigo-600 m-3 px-3 py-1.5 text-sm font-semibold leading-6 text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 mt-2"> Edit Pattern</a>
                        <a asp-controller="Pattern" asp-action="DeletePattern" asp-route-id="@Model.ActivePattern.PatternId" class="w-auto justify-center rounded-md bg-indigo-600 m-3 px-3 py-1.5 text-sm font-semibold leading-6 text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 mt-2"> Delete Pattern</a>
                    }
                </div> 

            </div>



        </div>

    </div>

</div>
